(()=>{"use strict";var t={8895:function(){var t;new WeakMap,t=void 0,t=>t},7984:function(t,e,s){s.d(e,{$:()=>$,B:()=>G,C:()=>tg,D:()=>L,E:()=>tI,F:()=>J,G:()=>t_,H:()=>function t(e,s,r,n){if("string"==typeof s){let t=tn(e,s).next(r,n);return t&&t.length?t:e.next(r,n)}if(1===Object.keys(s).length){let i=Object.keys(s),o=t(tn(e,i[0]),s[i[0]],r,n);return o&&o.length?o:e.next(r,n)}let i=[];for(let o of Object.keys(s)){let a=s[o];if(!a)continue;let h=t(tn(e,o),a,r,n);h&&i.push(...h)}return i.length?i:e.next(r,n)},I:()=>ty,J:()=>f,K:()=>tc,L:()=>tr,M:()=>p,N:()=>a,O:()=>W,P:()=>ti,Q:()=>tA,R:()=>E,S:()=>o,V:()=>M,W:()=>tk,c:()=>j,g:()=>to,l:()=>_,q:()=>Q,t:()=>m,u:()=>x,v:()=>K,w:()=>P,x:()=>w,y:()=>H,z:()=>Z});var r,n=s(6474);class i{constructor(t){this._process=t,this._active=!1,this._current=null,this._last=null}start(){this._active=!0,this.flush()}clear(){this._current&&(this._current.next=null,this._last=this._current)}enqueue(t){let e={value:t,next:null};if(this._current){this._last.next=e,this._last=e;return}this._current=e,this._last=e,this._active&&this.flush()}flush(){for(;this._current;){let t=this._current;this._process(t.value),this._current=t.next}this._last=null}}let o=".",a="",h="xstate.init",l="xstate.stop";function u(t,e){return{type:`xstate.done.state.${t}`,output:e}}function f(t){return{type:h,input:t}}function c(t){setTimeout(()=>{throw t})}let d="function"==typeof Symbol&&Symbol.observable||"@@observable";function p(t){if(g(t))return t;let e=[],s="";for(let r=0;r<t.length;r++){switch(t.charCodeAt(r)){case 92:s+=t[r+1],r++;continue;case 46:e.push(s),s="";continue}s+=t[r]}return e.push(s),e}function y(t){var e;return(e=t)&&"object"==typeof e&&"machine"in e&&"value"in e?t.value:"string"!=typeof t?t:function(t){if(1===t.length)return t[0];let e={},s=e;for(let e=0;e<t.length-1;e++)if(e===t.length-2)s[t[e]]=t[e+1];else{let r=s;s={},r[t[e]]=s}return e}(p(t))}function _(t,e){let s={},r=Object.keys(t);for(let n=0;n<r.length;n++){let i=r[n];s[i]=e(t[i],i,t,n)}return s}function m(t){var e;return void 0===t?[]:g(e=t)?e:[e]}function v(t,e,s,r){return"function"==typeof t?t({context:e,event:s,self:r}):t}function g(t){return Array.isArray(t)}function x(t){var e;return(g(e=t)?e:[e]).map(t=>void 0===t||"string"==typeof t?{target:t}:t)}function b(t){if(void 0!==t&&""!==t)return m(t)}function S(t,e,s){let r="object"==typeof t,n=r?t:void 0;return{next:(r?t.next:t)?.bind(n),error:(r?t.error:e)?.bind(n),complete:(r?t.complete:s)?.bind(n)}}function w(t,e){return`${e}.${t}`}function E(t,e){let s=e.match(/^xstate\.invoke\.(\d+)\.(.*)/);if(!s)return t.implementations.actors[e];let[,r,n]=s,i=t.getStateNodeById(n).config.invoke;return(Array.isArray(i)?i[r]:i).src}function I(t,e){return`${t.sessionId}.${e}`}let k=0,A=!1,$=1,M=((r={})[r.NotStarted=0]="NotStarted",r[r.Running=1]="Running",r[r.Stopped=2]="Stopped",r),O={clock:{setTimeout:(t,e)=>setTimeout(t,e),clearTimeout:t=>clearTimeout(t)},logger:console.log.bind(console),devTools:!1};class T{constructor(t,e){this.logic=t,this._snapshot=void 0,this.clock=void 0,this.options=void 0,this.id=void 0,this.mailbox=new i(this._process.bind(this)),this.observers=new Set,this.eventListeners=new Map,this.logger=void 0,this._processingStatus=M.NotStarted,this._parent=void 0,this._syncSnapshot=void 0,this.ref=void 0,this._actorScope=void 0,this._systemId=void 0,this.sessionId=void 0,this.system=void 0,this._doneEvent=void 0,this.src=void 0,this._deferred=[];let s={...O,...e},{clock:r,logger:n,parent:o,syncSnapshot:a,id:h,systemId:l,inspect:u}=s;this.system=o?o.system:function(t,e){let s=new Map,r=new Map,n=new WeakMap,i=new Set,o={},{clock:a,logger:h}=e,l={schedule:(t,e,s,r,n=Math.random().toString(36).slice(2))=>{let i={source:t,target:e,event:s,delay:r,id:n,startedAt:Date.now()},h=I(t,n);u._snapshot._scheduledEvents[h]=i;let l=a.setTimeout(()=>{delete o[h],delete u._snapshot._scheduledEvents[h],u._relay(t,e,s)},r);o[h]=l},cancel:(t,e)=>{let s=I(t,e),r=o[s];delete o[s],delete u._snapshot._scheduledEvents[s],void 0!==r&&a.clearTimeout(r)},cancelAll:t=>{for(let e in u._snapshot._scheduledEvents){let s=u._snapshot._scheduledEvents[e];s.source===t&&l.cancel(t,s.id)}}},u={_snapshot:{_scheduledEvents:(e?.snapshot&&e.snapshot.scheduler)??{}},_bookId:()=>`x:${k++}`,_register:(t,e)=>(s.set(t,e),t),_unregister:t=>{s.delete(t.sessionId);let e=n.get(t);void 0!==e&&(r.delete(e),n.delete(t))},get:t=>r.get(t),_set:(t,e)=>{let s=r.get(t);if(s&&s!==e)throw Error(`Actor with system ID '${t}' already exists.`);r.set(t,e),n.set(e,t)},inspect:t=>{let e=S(t);return i.add(e),{unsubscribe(){i.delete(e)}}},_sendInspectionEvent:e=>{if(!i.size)return;let s={...e,rootId:t.sessionId};i.forEach(t=>t.next?.(s))},_relay:(t,e,s)=>{u._sendInspectionEvent({type:"@xstate.event",sourceRef:t,actorRef:e,event:s}),e._send(s)},scheduler:l,getSnapshot:()=>({_scheduledEvents:{...u._snapshot._scheduledEvents}}),start:()=>{let t=u._snapshot._scheduledEvents;for(let e in u._snapshot._scheduledEvents={},t){let{source:s,target:r,event:n,delay:i,id:o}=t[e];l.schedule(s,r,n,i,o)}},_clock:a,_logger:h};return u}(this,{clock:r,logger:n}),u&&!o&&this.system.inspect(S(u)),this.sessionId=this.system._bookId(),this.id=h??this.sessionId,this.logger=e?.logger??this.system._logger,this.clock=e?.clock??this.system._clock,this._parent=o,this._syncSnapshot=a,this.options=s,this.src=s.src??t,this.ref=this,this._actorScope={self:this,id:this.id,sessionId:this.sessionId,logger:this.logger,defer:t=>{this._deferred.push(t)},system:this.system,stopChild:t=>{if(t._parent!==this)throw Error(`Cannot stop child actor ${t.id} of ${this.id} because it is not a child`);t._stop()},emit:t=>{let e=this.eventListeners.get(t.type),s=this.eventListeners.get("*");if(e||s)for(let r of[...e?e.values():[],...s?s.values():[]])try{r(t)}catch(t){c(t)}},actionExecutor:t=>{let e=()=>{if(this._actorScope.system._sendInspectionEvent({type:"@xstate.action",actorRef:this,action:{type:t.type,params:t.params}}),!t.exec)return;let e=A;try{A=!0,t.exec(t.info,t.params)}finally{A=e}};this._processingStatus===M.Running?e():this._deferred.push(e)}},this.send=this.send.bind(this),this.system._sendInspectionEvent({type:"@xstate.actor",actorRef:this}),l&&(this._systemId=l,this.system._set(l,this)),this._initState(e?.snapshot??e?.state),l&&"active"!==this._snapshot.status&&this.system._unregister(this)}_initState(t){try{this._snapshot=t?this.logic.restoreSnapshot?this.logic.restoreSnapshot(t,this._actorScope):t:this.logic.getInitialSnapshot(this._actorScope,this.options?.input)}catch(t){this._snapshot={status:"error",output:void 0,error:t}}}update(t,e){let s;for(this._snapshot=t;s=this._deferred.shift();)try{s()}catch(e){this._deferred.length=0,this._snapshot={...t,status:"error",error:e}}switch(this._snapshot.status){case"active":for(let e of this.observers)try{e.next?.(t)}catch(t){c(t)}break;case"done":var r;for(let e of this.observers)try{e.next?.(t)}catch(t){c(t)}this._stopProcedure(),this._complete(),this._doneEvent=(r=this.id,{type:`xstate.done.actor.${r}`,output:this._snapshot.output,actorId:r}),this._parent&&this.system._relay(this,this._parent,this._doneEvent);break;case"error":this._error(this._snapshot.error)}this.system._sendInspectionEvent({type:"@xstate.snapshot",actorRef:this,event:e,snapshot:t})}subscribe(t,e,s){let r=S(t,e,s);if(this._processingStatus!==M.Stopped)this.observers.add(r);else switch(this._snapshot.status){case"done":try{r.complete?.()}catch(t){c(t)}break;case"error":{let t=this._snapshot.error;if(r.error)try{r.error(t)}catch(t){c(t)}else c(t)}}return{unsubscribe:()=>{this.observers.delete(r)}}}on(t,e){let s=this.eventListeners.get(t);s||(s=new Set,this.eventListeners.set(t,s));let r=e.bind(void 0);return s.add(r),{unsubscribe:()=>{s.delete(r)}}}start(){if(this._processingStatus===M.Running)return this;this._syncSnapshot&&this.subscribe({next:t=>{"active"===t.status&&this.system._relay(this,this._parent,{type:`xstate.snapshot.${this.id}`,snapshot:t})},error:()=>{}}),this.system._register(this.sessionId,this),this._systemId&&this.system._set(this._systemId,this),this._processingStatus=M.Running;let t=f(this.options.input);switch(this.system._sendInspectionEvent({type:"@xstate.event",sourceRef:this._parent,actorRef:this,event:t}),this._snapshot.status){case"done":return this.update(this._snapshot,t),this;case"error":return this._error(this._snapshot.error),this}if(this._parent||this.system.start(),this.logic.start)try{this.logic.start(this._snapshot,this._actorScope)}catch(t){return this._snapshot={...this._snapshot,status:"error",error:t},this._error(t),this}return this.update(this._snapshot,t),this.options.devTools&&this.attachDevTools(),this.mailbox.start(),this}_process(t){let e,s;try{e=this.logic.transition(this._snapshot,t,this._actorScope)}catch(t){s={err:t}}if(s){let{err:t}=s;this._snapshot={...this._snapshot,status:"error",error:t},this._error(t);return}this.update(e,t),t.type===l&&(this._stopProcedure(),this._complete())}_stop(){return this._processingStatus===M.Stopped||((this.mailbox.clear(),this._processingStatus===M.NotStarted)?this._processingStatus=M.Stopped:this.mailbox.enqueue({type:l})),this}stop(){if(this._parent)throw Error("A non-root actor cannot be stopped directly.");return this._stop()}_complete(){for(let t of this.observers)try{t.complete?.()}catch(t){c(t)}this.observers.clear()}_reportError(t){if(!this.observers.size){this._parent||c(t);return}let e=!1;for(let s of this.observers){let r=s.error;e||=!r;try{r?.(t)}catch(t){c(t)}}this.observers.clear(),e&&c(t)}_error(t){var e;this._stopProcedure(),this._reportError(t),this._parent&&this.system._relay(this,this._parent,(e=this.id,{type:`xstate.error.actor.${e}`,error:t,actorId:e}))}_stopProcedure(){return this._processingStatus!==M.Running||(this.system.scheduler.cancelAll(this),this.mailbox.clear(),this.mailbox=new i(this._process.bind(this)),this._processingStatus=M.Stopped,this.system._unregister(this)),this}_send(t){this._processingStatus!==M.Stopped&&this.mailbox.enqueue(t)}send(t){this.system._relay(void 0,this,t)}attachDevTools(){let{devTools:t}=this.options;t&&("function"==typeof t?t:n.tm)(this)}toJSON(){return{xstate$$type:$,id:this.id}}getPersistedSnapshot(t){return this.logic.getPersistedSnapshot(this._snapshot,t)}[d](){return this}getSnapshot(){return this._snapshot}}function j(t,...[e]){return new T(t,e)}function N(t,e,s,r,{sendId:n}){return[e,{sendId:"function"==typeof n?n(s,r):n},void 0]}function R(t,e){t.defer(()=>{t.system.scheduler.cancel(t.self,e.sendId)})}function D(t,e,s,r,{id:n,systemId:i,src:o,input:a,syncSnapshot:h}){let l,u,f="string"==typeof o?E(e.machine,o):o,c="function"==typeof n?n(s):n;return f&&(u="function"==typeof a?a({context:e.context,event:s.event,self:t.self}):a,l=j(f,{id:c,src:o,parent:t.self,syncSnapshot:h,systemId:i,input:u})),[tk(e,{children:{...e.children,[c]:l}}),{id:n,systemId:i,actorRef:l,src:o,input:u},void 0]}function U(t,{actorRef:e}){e&&t.defer(()=>{e._processingStatus!==M.Stopped&&e.start()})}function B(t,e,s,r,{actorRef:n}){let i="function"==typeof n?n(s,r):n,o="string"==typeof i?e.children[i]:i,a=e.children;return o&&(a={...a},delete a[o.id]),[tk(e,{children:a}),o,void 0]}function C(t,e){if(e){if(t.system._unregister(e),e._processingStatus!==M.Running)return void t.stopChild(e);t.defer(()=>{t.stopChild(e)})}}function Y(t){function e(t,e){}return e.type="xstate.stopChild",e.actorRef=t,e.resolve=B,e.execute=C,e}function P(t,e,s,r){let{machine:n}=r,i="function"==typeof t,o=i?t:n.implementations.guards["string"==typeof t?t:t.type];if(!i&&!o)throw Error(`Guard '${"string"==typeof t?t:t.type}' is not implemented.'.`);if("function"!=typeof o)return P(o,e,s,r);let a={context:e,event:s},h=i||"string"==typeof t?void 0:"params"in t?"function"==typeof t.params?t.params({context:e,event:s}):t.params:void 0;return"check"in o?o.check(r,a,o):o(a,h)}let X=t=>"atomic"===t.type||"final"===t.type;function z(t){return Object.values(t.states).filter(t=>"history"!==t.type)}function V(t,e){let s=[];if(e===t)return s;let r=t.parent;for(;r&&r!==e;)s.push(r),r=r.parent;return s}function L(t){let e=new Set(t),s=q(e);for(let t of e)if("compound"!==t.type||s.get(t)&&s.get(t).length){if("parallel"===t.type){for(let s of z(t))if("history"!==s.type&&!e.has(s))for(let t of ts(s))e.add(t)}}else ts(t).forEach(t=>e.add(t));for(let t of e){let s=t.parent;for(;s;)e.add(s),s=s.parent}return e}function q(t){let e=new Map;for(let s of t)e.has(s)||e.set(s,[]),s.parent&&(e.has(s.parent)||e.set(s.parent,[]),e.get(s.parent).push(s));return e}function F(t,e){return function t(e,s){let r=s.get(e);if(!r)return{};if("compound"===e.type){let t=r[0];if(!t)return{};if(X(t))return t.key}let n={};for(let e of r)n[e.key]=t(e,s);return n}(t,q(L(e)))}function J(t,e){return"compound"===e.type?z(e).some(e=>"final"===e.type&&t.has(e)):"parallel"===e.type?z(e).every(e=>J(t,e)):"final"===e.type}let W=t=>"#"===t[0];function G(t,e){return t.transitions.get(e)||[...t.transitions.keys()].filter(t=>{if("*"===t)return!0;if(!t.endsWith(".*"))return!1;let s=t.split("."),r=e.split(".");for(let t=0;t<s.length;t++){let e=s[t],n=r[t];if("*"===e)return t===s.length-1;if(e!==n)return!1}return!0}).sort((t,e)=>e.length-t.length).flatMap(e=>t.transitions.get(e))}function H(t){let e=t.config.after;return e?Object.keys(e).flatMap(s=>{let r=e[s],n=Number.isNaN(+s)?s:+s,i=(e=>{var s;let r=(s=t.id,{type:`xstate.after.${e}.${s}`}),n=r.type;return t.entry.push(function(t,e){function s(t,e){}return s.type="xstate.raise",s.event=t,s.id=e?.id,s.delay=e?.delay,s.resolve=t$,s.execute=tM,s}(r,{id:n,delay:e})),t.exit.push(function(t){function e(t,e){}return e.type="xstate.cancel",e.sendId=t,e.resolve=N,e.execute=R,e}(n)),n})(n);return m("string"==typeof r?{target:r}:r).map(t=>({...t,event:i,delay:n}))}).map(e=>{let{delay:s}=e;return{...K(t,e.event,e),delay:s}}):[]}function K(t,e,s){let r=b(s.target),n=s.reenter??!1,i=function(t,e){if(void 0!==e)return e.map(e=>{if("string"!=typeof e)return e;if(W(e))return t.machine.getStateNodeById(e);let s=e[0]===o;if(s&&!t.parent)return ti(t,e.slice(1));let r=s?t.key+e:e;if(t.parent)try{return ti(t.parent,r)}catch(e){throw Error(`Invalid transition definition for state node '${t.id}':
${e.message}`)}throw Error(`Invalid target: "${e}" is not a valid target from the root node. Did you mean ".${e}"?`)})}(t,r),a={...s,actions:m(s.actions),guard:s.guard,target:i,source:t,reenter:n,eventType:e,toJSON:()=>({...a,source:`#${t.id}`,target:i?i.map(t=>`#${t.id}`):void 0})};return a}function Q(t){let e=new Map;if(t.config.on)for(let s of Object.keys(t.config.on)){if(s===a)throw Error('Null events ("") cannot be specified as a transition key. Use `always: { ... }` instead.');let r=t.config.on[s];e.set(s,x(r).map(e=>K(t,s,e)))}if(t.config.onDone){let s=`xstate.done.state.${t.id}`;e.set(s,x(t.config.onDone).map(e=>K(t,s,e)))}for(let s of t.invoke){if(s.onDone){let r=`xstate.done.actor.${s.id}`;e.set(r,x(s.onDone).map(e=>K(t,r,e)))}if(s.onError){let r=`xstate.error.actor.${s.id}`;e.set(r,x(s.onError).map(e=>K(t,r,e)))}if(s.onSnapshot){let r=`xstate.snapshot.${s.id}`;e.set(r,x(s.onSnapshot).map(e=>K(t,r,e)))}}for(let s of t.after){let t=e.get(s.eventType);t||(t=[],e.set(s.eventType,t)),t.push(s)}return e}function Z(t,e){let s="string"==typeof e?t.states[e]:e?t.states[e.target]:void 0;if(!s&&e)throw Error(`Initial state node "${e}" not found on parent state node #${t.id}`);let r={source:t,actions:e&&"string"!=typeof e?m(e.actions):[],eventType:null,reenter:!1,target:s?[s]:[],toJSON:()=>({...r,source:`#${t.id}`,target:s?[`#${s.id}`]:[]})};return r}function tt(t){let e=b(t.config.target);return e?{target:e.map(e=>"string"==typeof e?ti(t.parent,e):e)}:t.parent.initial}function te(t){return"history"===t.type}function ts(t){let e=tr(t);for(let s of e)for(let r of V(s,t))e.add(r);return e}function tr(t){let e=new Set;return!function t(s){if(!e.has(s)){if(e.add(s),"compound"===s.type)t(s.initial.target[0]);else if("parallel"===s.type)for(let e of z(s))t(e)}}(t),e}function tn(t,e){if(W(e))return t.machine.getStateNodeById(e);if(!t.states)throw Error(`Unable to retrieve child state '${e}' from '${t.id}'; no child states exist.`);let s=t.states[e];if(!s)throw Error(`Child state '${e}' does not exist on '${t.id}'`);return s}function ti(t,e){if("string"==typeof e&&W(e))try{return t.machine.getStateNodeById(e)}catch{}let s=p(e).slice(),r=t;for(;s.length;){let t=s.shift();if(!t.length)break;r=tn(r,t)}return r}function to(t,e){if("string"==typeof e){let s=t.states[e];if(!s)throw Error(`State '${e}' does not exist on '${t.id}'`);return[t,s]}let s=Object.keys(e),r=s.map(e=>tn(t,e)).filter(Boolean);return[t.machine.root,t].concat(r,s.reduce((s,r)=>{let n=tn(t,r);if(!n)return s;let i=to(n,e[r]);return s.concat(i)},[]))}function ta(t,e){let s=t;for(;s.parent&&s.parent!==e;)s=s.parent;return s.parent===e}function th(t,e,s){let r=new Set;for(let n of t){let t=!1,i=new Set;for(let o of r)if(function(t,e){let s=new Set(t),r=new Set(e);for(let t of s)if(r.has(t))return!0;for(let t of r)if(s.has(t))return!0;return!1}(tf([n],e,s),tf([o],e,s)))if(ta(n.source,o.source))i.add(o);else{t=!0;break}if(!t){for(let t of i)r.delete(t);r.add(n)}}return Array.from(r)}function tl(t,e){if(!t.target)return[];let s=new Set;for(let r of t.target)if(te(r))if(e[r.id])for(let t of e[r.id])s.add(t);else for(let t of tl(tt(r),e))s.add(t);else s.add(r);return[...s]}function tu(t,e){let s=tl(t,e);if(!s)return;if(!t.reenter&&s.every(e=>e===t.source||ta(e,t.source)))return t.source;let r=function(t){let[e,...s]=t;for(let t of V(e,void 0))if(s.every(e=>ta(e,t)))return t}(s.concat(t.source));return r||(t.reenter?void 0:t.source.machine.root)}function tf(t,e,s){let r=new Set;for(let n of t)if(n.target?.length){let t=tu(n,s);for(let s of(n.reenter&&n.source===t&&r.add(t),e))ta(s,t)&&r.add(s)}return[...r]}function tc(t,e,s,r,n,i){if(!t.length)return e;let o=new Set(e._nodes),a=e.historyValue,h=th(t,o,a),l=e;n||([l,a]=function(t,e,s,r,n,i,o,a){let h,l=t,u=tf(r,n,i);for(let t of(u.sort((t,e)=>e.order-t.order),u))for(let e of function(t){return Object.keys(t.states).map(e=>t.states[e]).filter(t=>"history"===t.type)}(t)){let s;s="deep"===e.history?e=>X(e)&&ta(e,t):e=>e.parent===t,(h??={...i})[e.id]=Array.from(n).filter(s)}for(let t of u)l=ty(l,e,s,[...t.exit,...t.invoke.map(t=>Y(t.id))],o,void 0),n.delete(t);return[l,h||i]}(l,r,s,h,o,a,i,s.actionExecutor)),l=function(t,e,s,r,n,i,o,a){let h=t,l=new Set,f=new Set;(function(t,e,s,r){for(let n of t){let t=tu(n,e);for(let i of n.target||[])!te(i)&&(n.source!==i||n.source!==t||n.reenter)&&(r.add(i),s.add(i)),td(i,e,s,r);for(let i of tl(n,e)){let o=V(i,t);t?.type==="parallel"&&o.push(t),tp(r,e,s,o,!n.source.parent&&n.reenter?void 0:t)}}})(r,o,f,l),a&&f.add(t.machine.root);let c=new Set;for(let t of[...l].sort((t,e)=>t.order-e.order)){n.add(t);let r=[];for(let e of(r.push(...t.entry),t.invoke))r.push(function(...[t,{id:e,systemId:s,input:r,syncSnapshot:n=!1}={}]){function i(t,e){}return i.type="xstate.spawnChild",i.id=e,i.systemId=s,i.src=t,i.input=r,i.syncSnapshot=n,i.resolve=D,i.execute=U,i}(e.src,{...e,syncSnapshot:!!e.onSnapshot}));if(f.has(t)){let e=t.initial.actions;r.push(...e)}if(h=ty(h,e,s,r,i,t.invoke.map(t=>t.id)),"final"===t.type){let r=t.parent,o=r?.type==="parallel"?r:r?.parent,a=o||t;for(r?.type==="compound"&&i.push(u(r.id,void 0!==t.output?v(t.output,h.context,e,s.self):void 0));o?.type==="parallel"&&!c.has(o)&&J(n,o);)c.add(o),i.push(u(o.id)),a=o,o=o.parent;if(o)continue;h=tk(h,{status:"done",output:function(t,e,s,r,n){if(void 0===r.output)return;let i=u(n.id,void 0!==n.output&&n.parent?v(n.output,t.context,e,s.self):void 0);return v(r.output,t.context,i,s.self)}(h,e,s,h.machine.root,a)})}}return h}(l=ty(l,r,s,h.flatMap(t=>t.actions),i,void 0),r,s,h,o,i,a,n);let f=[...o];"done"===l.status&&(l=ty(l,r,s,f.sort((t,e)=>e.order-t.order).flatMap(t=>t.exit),i,void 0));try{if(a===e.historyValue&&function(t,e){if(t.length!==e.size)return!1;for(let s of t)if(!e.has(s))return!1;return!0}(e._nodes,o))return l;return tk(l,{_nodes:f,historyValue:a})}catch(t){throw t}}function td(t,e,s,r){var n,i,o,a;if(te(t))if(e[t.id]){let o=e[t.id];for(let t of o)r.add(t),td(t,e,s,r);for(let a of o){n=a,i=t.parent,tp(r,e,s,V(n,i))}}else{let n=tt(t);for(let i of n.target)r.add(i),n===t.parent?.initial&&s.add(t.parent),td(i,e,s,r);for(let i of n.target){o=i,a=t.parent,tp(r,e,s,V(o,a))}}else if("compound"===t.type){let[n]=t.initial.target;te(n)||(r.add(n),s.add(n)),td(n,e,s,r),tp(r,e,s,V(n,t))}else if("parallel"===t.type)for(let n of z(t).filter(t=>!te(t)))[...r].some(t=>ta(t,n))||(te(n)||(r.add(n),s.add(n)),td(n,e,s,r))}function tp(t,e,s,r,n){for(let i of r)if((!n||ta(i,n))&&t.add(i),"parallel"===i.type)for(let r of z(i).filter(t=>!te(t)))[...t].some(t=>ta(t,r))||(t.add(r),td(r,e,s,t))}function ty(t,e,s,r,n,i){let o=i?[]:void 0,a=function t(e,s,r,n,i,o){let{machine:a}=e,h=e;for(let e of n){var l;let n="function"==typeof e,u=n?e:(l="string"==typeof e?e:e.type,a.implementations.actions[l]),f={context:h.context,event:s,self:r.self,system:r.system},c=n||"string"==typeof e?void 0:"params"in e?"function"==typeof e.params?e.params({context:h.context,event:s}):e.params:void 0;if(!u||!("resolve"in u)){r.actionExecutor({type:"string"==typeof e?e:"object"==typeof e?e.type:e.name||"(anonymous)",info:f,params:c,exec:u});continue}let[d,p,y]=u.resolve(r,h,f,c,u,i);h=d,"retryResolve"in u&&o?.push([u,p]),"execute"in u&&r.actionExecutor({type:u.type,info:f,params:p,exec:u.execute.bind(null,r,p)}),y&&(h=t(h,s,r,y,i,o))}return h}(t,e,s,r,{internalQueue:n,deferredActorIds:i},o);return o?.forEach(([t,e])=>{t.retryResolve(s,a,e)}),a}function t_(t,e,s,r){let n=t,i=[];function o(t,e,r){s.system._sendInspectionEvent({type:"@xstate.microstep",actorRef:s.self,event:e,snapshot:t,_transitions:r}),i.push(t)}if(e.type===l)return o(n=tk(tm(n,e,s),{status:"stopped"}),e,[]),{snapshot:n,microstates:i};let a=e;if(a.type!==h){let e=a,h=e.type.startsWith("xstate.error.actor"),l=tv(e,n);if(h&&!l.length)return o(n=tk(t,{status:"error",error:e.error}),e,[]),{snapshot:n,microstates:i};o(n=tc(l,t,s,a,!1,r),e,l)}let u=!0;for(;"active"===n.status;){let t=u?function(t,e){let s=new Set;for(let r of t._nodes.filter(X))t:for(let n of[r].concat(V(r,void 0)))if(n.always){for(let r of n.always)if(void 0===r.guard||P(r.guard,t.context,e,t)){s.add(r);break t}}return th(Array.from(s),new Set(t._nodes),t.historyValue)}(n,a):[],e=t.length?n:void 0;if(!t.length){if(!r.length)break;t=tv(a=r.shift(),n)}u=(n=tc(t,n,s,a,!1,r))!==e,o(n,a,t)}return"active"!==n.status&&tm(n,a,s),{snapshot:n,microstates:i}}function tm(t,e,s){return ty(t,e,s,Object.values(t.children).map(t=>Y(t)),[],void 0)}function tv(t,e){return e.machine.getTransitionData(e,t)}function tg(t,e){let s=L(to(t,e));return F(t,[...s])}let tx=function(t){return function t(e,s){let r=y(e),n=y(s);return"string"==typeof n?"string"==typeof r&&n===r:"string"==typeof r?r in n:Object.keys(r).every(e=>e in n&&t(r[e],n[e]))}(t,this.value)},tb=function(t){return this.tags.has(t)},tS=function(t){let e=this.machine.getTransitionData(this,t);return!!e?.length&&e.some(t=>void 0!==t.target||t.actions.length)},tw=function(){let{_nodes:t,tags:e,machine:s,getMeta:r,toJSON:n,can:i,hasTag:o,matches:a,...h}=this;return{...h,tags:Array.from(e)}},tE=function(){return this._nodes.reduce((t,e)=>(void 0!==e.meta&&(t[e.id]=e.meta),t),{})};function tI(t,e){return{status:t.status,output:t.output,error:t.error,machine:e,context:t.context,_nodes:t._nodes,value:F(e.root,t._nodes),tags:new Set(t._nodes.flatMap(t=>t.tags)),children:t.children,historyValue:t.historyValue||{},matches:tx,hasTag:tb,can:tS,getMeta:tE,toJSON:tw}}function tk(t,e={}){return tI({...t,...e},t.machine)}function tA(t,e){let{_nodes:s,tags:r,machine:n,children:i,context:o,can:a,hasTag:h,matches:l,getMeta:u,toJSON:f,...c}=t,d={};for(let t in i){let s=i[t];d[t]={snapshot:s.getPersistedSnapshot(e),src:s.src,systemId:s._systemId,syncSnapshot:s._syncSnapshot}}return{...c,context:function t(e){let s;for(let r in e){let n=e[r];if(n&&"object"==typeof n)if("sessionId"in n&&"send"in n&&"ref"in n)(s??=Array.isArray(e)?e.slice():{...e})[r]={xstate$$type:$,id:n.id};else{let i=t(n);i!==n&&((s??=Array.isArray(e)?e.slice():{...e})[r]=i)}}return s??e}(o),children:d,historyValue:function(t){if("object"!=typeof t||null===t)return{};let e={};for(let s in t){let r=t[s];Array.isArray(r)&&(e[s]=r.map(t=>({id:t.id})))}return e}(c.historyValue)}}function t$(t,e,s,r,{event:n,id:i,delay:o},{internalQueue:a}){let h,l=e.machine.implementations.delays;if("string"==typeof n)throw Error(`Only event objects may be used with raise; use raise({ type: "${n}" }) instead`);let u="function"==typeof n?n(s,r):n;if("string"==typeof o){let t=l&&l[o];h="function"==typeof t?t(s,r):t}else h="function"==typeof o?o(s,r):o;return"number"!=typeof h&&a.push(u),[e,{event:u,id:i,delay:h},void 0]}function tM(t,e){let{event:s,delay:r,id:n}=e;if("number"==typeof r)return void t.defer(()=>{let e=t.self;t.system.scheduler.schedule(e,e,s,r,n)})}},7778:function(t,e,s){var r=s(2992),n=s(9908),i=s(7984);class o{constructor(){this.ids=[],this.values=[],this.length=0}clear(){this.length=0}push(t,e){let s=this.length++;for(;s>0;){let t=s-1>>1,r=this.values[t];if(e>=r)break;this.ids[s]=this.ids[t],this.values[s]=r,s=t}this.ids[s]=t,this.values[s]=e}pop(){if(0===this.length)return;let t=this.ids,e=this.values,s=t[0],r=--this.length;if(r>0){let s=t[r],n=e[r],i=0,o=r>>1;for(;i<o;){let s=(i<<1)+1,o=s+1,a=s+(o<r&e[o]<e[s]);if(e[a]>=n)break;t[i]=t[a],e[i]=e[a],i=a}t[i]=s,e[i]=n}return s}peek(){return this.length>0?this.ids[0]:void 0}peekValue(){return this.length>0?this.values[0]:void 0}shrink(){this.ids.length=this.values.length=this.length}}let a=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class h{static from(t,e=0){if(e%8!=0)throw Error("byteOffset must be 8-byte aligned.");if(!t||void 0===t.byteLength||t.buffer)throw Error("Data must be an instance of ArrayBuffer or SharedArrayBuffer.");let[s,r]=new Uint8Array(t,e+0,2);if(251!==s)throw Error("Data does not appear to be in a Flatbush format.");let n=r>>4;if(3!==n)throw Error(`Got v${n} data when expected v3.`);let i=a[15&r];if(!i)throw Error("Unrecognized array type.");let[o]=new Uint16Array(t,e+2,1),[l]=new Uint32Array(t,e+4,1);return new h(l,o,i,void 0,t,e)}constructor(t,e=16,s=Float64Array,r=ArrayBuffer,n,i=0){if(void 0===t)throw Error("Missing required argument: numItems.");if(isNaN(t)||t<=0)throw Error(`Unexpected numItems value: ${t}.`);this.numItems=+t,this.nodeSize=Math.min(Math.max(+e,2),65535),this.byteOffset=i;let h=t,l=h;this._levelBounds=[4*h];do l+=h=Math.ceil(h/this.nodeSize),this._levelBounds.push(4*l);while(1!==h);this.ArrayType=s,this.IndexArrayType=l<16384?Uint16Array:Uint32Array;let u=a.indexOf(s),f=4*l*s.BYTES_PER_ELEMENT;if(u<0)throw Error(`Unexpected typed array class: ${s}.`);if(n)this.data=n,this._boxes=new s(n,i+8,4*l),this._indices=new this.IndexArrayType(n,i+8+f,l),this._pos=4*l,this.minX=this._boxes[this._pos-4],this.minY=this._boxes[this._pos-3],this.maxX=this._boxes[this._pos-2],this.maxY=this._boxes[this._pos-1];else{let n=this.data=new r(8+f+l*this.IndexArrayType.BYTES_PER_ELEMENT);this._boxes=new s(n,8,4*l),this._indices=new this.IndexArrayType(n,8+f,l),this._pos=0,this.minX=1/0,this.minY=1/0,this.maxX=-1/0,this.maxY=-1/0,new Uint8Array(n,0,2).set([251,48+u]),new Uint16Array(n,2,1)[0]=e,new Uint32Array(n,4,1)[0]=t}this._queue=new o}add(t,e,s=t,r=e){let n=this._pos>>2,i=this._boxes;return this._indices[n]=n,i[this._pos++]=t,i[this._pos++]=e,i[this._pos++]=s,i[this._pos++]=r,t<this.minX&&(this.minX=t),e<this.minY&&(this.minY=e),s>this.maxX&&(this.maxX=s),r>this.maxY&&(this.maxY=r),n}finish(){if(this._pos>>2!==this.numItems)throw Error(`Added ${this._pos>>2} items when expected ${this.numItems}.`);let t=this._boxes;if(this.numItems<=this.nodeSize){t[this._pos++]=this.minX,t[this._pos++]=this.minY,t[this._pos++]=this.maxX,t[this._pos++]=this.maxY;return}let e=this.maxX-this.minX||1,s=this.maxY-this.minY||1,r=new Uint32Array(this.numItems);for(let n=0,i=0;n<this.numItems;n++){let o=t[i++],a=t[i++],h=t[i++],l=t[i++],u=Math.floor(65535*((o+h)/2-this.minX)/e),f=Math.floor(65535*((a+l)/2-this.minY)/s);r[n]=function(t,e){let s=t^e,r=65535^s,n=65535^(t|e),i=t&(65535^e),o=s|r>>1,a=s>>1^s,h=n>>1^r&i>>1^n,l=s&n>>1^i>>1^i;s=o,r=a,n=h,i=l,o=s&s>>2^r&r>>2,a=s&r>>2^r&(s^r)>>2,h^=s&n>>2^r&i>>2,l^=r&n>>2^(s^r)&i>>2,s=o,r=a,n=h,i=l,o=s&s>>4^r&r>>4,a=s&r>>4^r&(s^r)>>4,h^=s&n>>4^r&i>>4,l^=r&n>>4^(s^r)&i>>4,s=o,r=a,n=h,h^=s&n>>8^r&(i=l)>>8,l^=r&n>>8^(s^r)&i>>8,s=h^h>>1;let u=t^e,f=(r=l^l>>1)|65535^(u|s);return((f=((f=((f=((f=(f|f<<8)&0xff00ff)|f<<4)&0xf0f0f0f)|f<<2)&0x33333333)|f<<1)&0x55555555)<<1|(u=((u=((u=((u=(u|u<<8)&0xff00ff)|u<<4)&0xf0f0f0f)|u<<2)&0x33333333)|u<<1)&0x55555555))>>>0}(u,f)}!function t(e,s,r,n,i,o){if(Math.floor(n/o)>=Math.floor(i/o))return;let a=e[n],h=e[n+i>>1],l=e[i],u=l,f=Math.max(a,h);l>f?u=f:f===a?u=Math.max(h,l):f===h&&(u=Math.max(a,l));let c=n-1,d=i+1;for(;;){do c++;while(e[c]<u);do d--;while(e[d]>u);if(c>=d)break;!function(t,e,s,r,n){let i=t[r];t[r]=t[n],t[n]=i;let o=4*r,a=4*n,h=e[o],l=e[o+1],u=e[o+2],f=e[o+3];e[o]=e[a],e[o+1]=e[a+1],e[o+2]=e[a+2],e[o+3]=e[a+3],e[a]=h,e[a+1]=l,e[a+2]=u,e[a+3]=f;let c=s[r];s[r]=s[n],s[n]=c}(e,s,r,c,d)}t(e,s,r,n,d,o),t(e,s,r,d+1,i,o)}(r,t,this._indices,0,this.numItems-1,this.nodeSize);for(let e=0,s=0;e<this._levelBounds.length-1;e++){let r=this._levelBounds[e];for(;s<r;){let e=s,n=t[s++],i=t[s++],o=t[s++],a=t[s++];for(let e=1;e<this.nodeSize&&s<r;e++)n=Math.min(n,t[s++]),i=Math.min(i,t[s++]),o=Math.max(o,t[s++]),a=Math.max(a,t[s++]);this._indices[this._pos>>2]=e,t[this._pos++]=n,t[this._pos++]=i,t[this._pos++]=o,t[this._pos++]=a}}}search(t,e,s,r,n){if(this._pos!==this._boxes.length)throw Error("Data not yet indexed - call index.finish().");let i=this._boxes.length-4,o=[],a=[];for(;void 0!==i;){let h=Math.min(i+4*this.nodeSize,l(i,this._levelBounds));for(let l=i;l<h;l+=4){let h=this._boxes[l];if(s<h)continue;let u=this._boxes[l+1];if(r<u)continue;let f=this._boxes[l+2];if(t>f)continue;let c=this._boxes[l+3];if(e>c)continue;let d=0|this._indices[l>>2];i>=4*this.numItems?o.push(d):(void 0===n||n(d,h,u,f,c))&&a.push(d)}i=o.pop()}return a}neighbors(t,e,s=1/0,r=1/0,n){if(this._pos!==this._boxes.length)throw Error("Data not yet indexed - call index.finish().");let i=this._boxes.length-4,o=this._queue,a=[],h=r*r;e:for(;void 0!==i;){let r=Math.min(i+4*this.nodeSize,l(i,this._levelBounds));for(let s=i;s<r;s+=4){let r=0|this._indices[s>>2],a=this._boxes[s],l=this._boxes[s+1],u=this._boxes[s+2],f=this._boxes[s+3],c=t<a?a-t:t>u?t-u:0,d=e<l?l-e:e>f?e-f:0,p=c*c+d*d;!(p>h)&&(i>=4*this.numItems?o.push(r<<1,p):(void 0===n||n(r))&&o.push((r<<1)+1,p))}for(;o.length&&1&o.peek();)if(o.peekValue()>h||(a.push(o.pop()>>1),a.length===s))break e;i=o.length?o.pop()>>1:void 0}return o.clear(),a}}function l(t,e){let s=0,r=e.length-1;for(;s<r;){let n=s+r>>1;e[n]>t?r=n:s=n+1}return e[s]}let u=(0,r.cY)({types:{events:{},context:{}},actions:{initDone:()=>postMessage({type:"INIT.DONE"}),doSearch:({context:{ctx:t}},{pgeo:e})=>{if(null===t)return;let s=function({b:t,m:e},s){let{fb:r,idxs:n}=t,i=r.neighbors(s.x,s.y,1,100);if(0===i.length)return null;let o=i[0],a=n[`${o}`],h=e.get(a);return void 0===h?null:{address:a,lonlat:h}}(t,e);null!==s&&postMessage({type:"SEARCH.DONE",res:s})}}}).createMachine({context:{ctx:null},initial:"Uninited",states:{Uninited:{on:{INIT:{actions:[(0,n.a)({ctx:({event:t})=>{var e;return{b:function(t){let e=new h(t.length),s={};for(let{a:r,lonlat:{x:n,y:i}}of t){let t=e.add(n,i);s[`${t}`]=r}return e.finish(),{fb:e,idxs:s}}(e=t.entries),m:new Map(e.map(({a:t,lonlat:e})=>[t,e]))}}}),{type:"initDone"}],target:"Inited"}}},Inited:{on:{SEARCH:[{actions:{type:"doSearch",params:({event:{pgeo:t}})=>({pgeo:t})}}]}}}}),f=(0,i.c)(u);f.start(),onmessage=function(t){var e;e=t.data,f.send(e)}}},e={};function s(r){var n=e[r];if(void 0!==n)return n.exports;var i=e[r]={exports:{}};return t[r](i,i.exports,s),i.exports}s.m=t,s.x=()=>{var t=s.O(void 0,["498"],function(){return s(7778)});return s.O(t)},s.d=(t,e)=>{for(var r in e)s.o(e,r)&&!s.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},s.f={},s.e=t=>Promise.all(Object.keys(s.f).reduce((e,r)=>(s.f[r](t,e),e),[])),s.u=t=>"static/js/"+t+".befb4152.js",s.miniCssF=t=>""+t+".css",s.g=(()=>{if("object"==typeof globalThis)return globalThis;try{return this||Function("return this")()}catch(t){if("object"==typeof window)return window}})(),s.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),(()=>{var t=[];s.O=(e,r,n,i)=>{if(r){i=i||0;for(var o=t.length;o>0&&t[o-1][2]>i;o--)t[o]=t[o-1];t[o]=[r,n,i];return}for(var a=1/0,o=0;o<t.length;o++){for(var[r,n,i]=t[o],h=!0,l=0;l<r.length;l++)(!1&i||a>=i)&&Object.keys(s.O).every(t=>s.O[t](r[l]))?r.splice(l--,1):(h=!1,i<a&&(a=i));if(h){t.splice(o--,1);var u=n();void 0!==u&&(e=u)}}return e}})(),s.p="/demos/OsakaCastle/",(()=>{var t=s.x;s.x=()=>s.e("498").then(t)})(),(()=>{var t={300:1};s.f.i=(e,r)=>{t[e]||importScripts(s.p+s.u(e))};var e=self.webpackChunk=self.webpackChunk||[],r=e.push.bind(e);e.push=e=>{var[n,i,o]=e;for(var a in i)s.o(i,a)&&(s.m[a]=i[a]);for(o&&o(s);n.length;)t[n.pop()]=1;r(e)}})(),s.x()})();